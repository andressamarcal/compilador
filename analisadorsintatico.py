tabela_slr = [   2,       99,      99,     99,   99,  99,  99,     99,     99,     99,        99,  99,   99,   99,  99, 99,   99,   99,    99,     99,   99,   1,  99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,     99,   99,  99,  99,     99,     99,     99,        99,  99,   99,   99,  99, 99,   99,   99,    99,     99,   00,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,       4,      99,     99,   99,  99,  99,     99,     99,     99,        99,  99,   99,   99,  99, 99,   99,   99,    99,     99,   99,   99,  3, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,     12,   99,  99,  99,     10,     11,     99,        99,  99,   99,   13,  99, 99,   99,   99,    99,      9,   99,   99, 99, 99,  99,  99,   5,   7,   99,   8,   99,   99,    6,         14,    99,    99],
[   99,      99,      17,     49,   99,  99,  99,     99,     99,     99,        99,  99,   99,   99,  99, 99,   99,   99,    99,     99,   99,   99, 99, 15,  16,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,    "r5",  99,  99,  99,   "r5",   "r5",     99,        99,  99,   99, "r5",  99, 99,   99,   99,    99,   "r5",   99,   99, 99, 99,  99,  99,   5,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,     12,   99,  99,  99,     10,     11,     99,        99,  99,   99,   13,  99, 99,   99,   99,    99,      9,   99,   99, 99, 99,  99,  99,  18,   7,   99,   8,   99,   99,    6,         14,    99,    99],
[   99,      99,      99,     12,   99,  99,  99,     10,     11,     99,        99,  99,   99,   13,  99, 99,   99,   99,    99,      9,   99,   99, 99, 99,  99,  99,  57,   7,   99,   8,   99,   99,    6,         14,    99,    99],
[   99,      99,      99,     12,   99,  99,  99,     10,     11,     99,        99,  99,   99,   13,  99, 99,   99,   99,    99,     99,   99,   99, 99, 99,  99,  99,  19,   7,   99,   8,   99,   99,    6,         14,    99,    99],
[   99,      99,      99,     99,   99,  99,  99,     99,     99,     99,        99,  99,   99,   99,  99, 99,   99,   99,    99,     99,"r30",   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,     20,   99,  99,  99,     99,     99,     99,        99,  99,   99,   99,  99, 99,   99,   99,    99,     99,   00,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,     23,   99,  99,  99,     99,     99,     22,        24,  99,   99,   99,  99, 99,   99,   99,    99,     99,   99,   99, 99, 99,  99,  99,  99,  99,   21,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,     99,   99,  99,  99,     99,     99,     99,        99,  25,   99,   99,  99, 99,   99,   99,    99,     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,     99,   99,  99,  99,     99,     99,     99,        99,  99,   99,   99,  26, 99,   99,   99,    99,     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,     12,   99,  99,  99,     10,     11,     99,        99,  99,   99,   13,  99, 99,   99,   99,    30,     99,   99,   99, 99, 99,  99,  99,  99,  28,   99,  29,   99,   99,   55,         99,    99,    27],
[   99,      99,      99,   "r3",   99,  99,  99,   "r3",   "r3",     99,        99,  99,   99, "r3",  99, 99,   99,   99,    99,   "r3",   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      17,     49,   99,  99,  99,     99,     99,     99,        99,  99,   99,   99,  99, 99,   99,   99,    99,     99,   99,   99, 99, 31,  16,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,   "r5",   58,  99,  99,   "r5",   "r5",     99,        99,  99,   99, "r5",  99, 99,   99,   99,    99,     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,     99,   99,  99,  99,     99,     99,     99,        99,  99,   99,   99,  99, 99,   99,   99,    99,     99,"r22",   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,  "r16",   99,  99,  99, "r16",  "r16",      99,        99,  99,   99, "r16", 99, 99,   99,   99,    99, "r16",    99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,  "r11",   32,  99,  99, "r11",  "r11",      99,        99,  99,   99, "r11", 99, 99,   99,   99,    99, "r11",    99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,     99,   48,  99,  99,     99,     99,     99,        99,  99,   99,   99,  99, 99,   99,   99,    99,     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,     99,"r13",  99,  99,     99,     99,     99,        99,  99,   99,   99,  99, 99,   99,   99,    99,     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,     99,"r15",  99,  99,     99,     99,     99,        99,  99,   99,   99,  99, 99,   99,   99,    99,     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,     99,"r14",  99,  99,     99,     99,     99,        99,  99,   99,   99,  99, 99,   99,   99,    99,     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,     35,  99,   99,  99,     99,     99,     99,        36,  99,   99,   99,  99, 99,   99,   99,    99,     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   33,   34,   99,         99,    99,    99],
[   99,      99,      99,     35,  99,   99,  99,     99,     99,     99,        36,  99,   99,   99,  99, 99,   99,   99,    99,     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   38,   99,         99,    37,    99],
[   99,      99,      99,  "r23",  99,   99,  99,  "r23",  "r23",     99,        99,  99,   99,"r23",  99, 99,   99,   99, "r23",     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,     12,  99,   99,  99,     10,     11,     99,        99,  99,   99,   99,  99, 99,   99,   99,    30,     99,   99,   99, 99, 99,  99,  99,  99,  28,   99,  29,   99,   99,   99,         99,    99,    39],
[   99,      99,      99,     12,  99,   99,  99,     10,     11,     99,        99,  99,   99,   99,  99, 99,   99,   99,    99,     99,   99,   99, 99, 99,  99,  99,  99,  28,   99,  29,   99,   99,   99,         99,    99,    40],
[   99,      99,      99,  "r29",  99,   99,  99,  "r29",  "r29",     99,        99,  99,   99,"r29",  99, 99,   99,   99, "r29",     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,   "r4",  99,   99,  99,   "r4",   "r4",     99,        99,  99,   99, "r4",  99, 99,   99,   99,    99,   "r4",   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,  "r11",  99,   99,  99,  "r11",  "r11",     99,        99,  99,   99,"r11",  99, 99,   99,   99, "r11",     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,     99,  41,   99,  99,     99,     99,     99,        99,  99,   99,   99,  99, 99,   99,   99,    99,     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,     99,  99,   99,  99,     99,     99,     99,        99,  99,   42,   99,  99, 99,   99,   99,    99,     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,     99,"r20",  99,  99,     99,     99,     99,        99,  99,"r20",   99,  99,"r20", 99,"r20",    99,     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,     99,"r21",  99,  99,     99,     99,     99,        99,  99,"r21",   99,  99,"r21", 99,"r21",    99,     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,     99,  99,   99,  99,     99,     99,     99,        99,  99,   99,   99,  99, 43,   99,   99,    99,     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,     99,  99,   99,  99,     99,     99,     99,        99,  99,   99,   99,  99, 99,   99,   44,    99,     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,   "r26", 99,   99,  99,  "r26",  "r26",     99,        99,  99,   99,"r26",  99, 99,   99,   99, "r26",     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,   "r27", 99,   99,  99,  "r27",  "r27",     99,        99,  99,   99,   99,  99, 99,   99,   99, "r27",     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,   "r17", 99,   99,  99,  "r17",  "r17",     99,        99,  99,   99,"r17",  99, 99,   99,   99, "r17",  "r17",   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,     99,"r18",  99,  99,     99,     99,     99,        99,  99,   99,   99,  99, 99,   99,   99,    99,     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   45,   99,         99,    99,    99],
[   99,      99,      99,     99,  99,   99,  99,     99,     99,     99,        99,  99,   99,   99,  99, 99,   46,   99,    99,      99,  99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,     35,  99,   99,  99,     99,     99,     99,        26,  99,   99,   99,  99, 99,   99,   99,    99,     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   47,   99,         99,    99,    99],
[   99,      99,      99,     99,"r18",  99,  99,     99,     99,     99,        99,  99,   99,   99,  99, 99,   99,   99,    99,     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,   "r24", 99,   99,  99,  "r24",  "r24",     99,        99,  99,   99, "r24", 99, 99,   99,   99, "r24",     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,     99, "r5",  99,  99,     99,     99,     99,        99,  99,   99,   99,  99, 99,   99,   99,    99,     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,   "r12", 99,   99,  99,   "r12",  "r12",    99,        99,  99,   99,"r12",  99, 99,   99,   99, "r12",  "r12",   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,      99, 99,   51,  52,     99,     99,     53,        99,  99,   99,   99,  99, 99,   99,   99,    99,     99,   99,   99, 99, 99,  99,  50,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,      99, 54,   99,  99,     99,     99,     99,        99,  99,   99,   99,  99, 99,   99,   99,    99,     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,      99,"r7",  99,  99,     99,     99,     99,        99,  99,   99,   99,  99, 99,   99,   99,    99,     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,      99,"r8",  99,  99,     99,     99,     99,        99,  99,   99,   99,  99, 99,   99,   99,    99,     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,      99,"r9",  99,  99,     99,     99,     99,        99,  99,   99,   99,  99, 99,   99,   99,    99,     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,    "r6",    "r6", 99,   99,  99,     99,     99,     99,        99,  99,   99,   99,  99, 99,   99,   99,    99,     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,      99, 99,   99,  99,     99,     99,     99,        99,  99,   99,   99,  99, 99,   99,   99,    30,     99,   99,   99, 99, 99,  99,  99,  99,  99,   28,  29,   99,   99,   99,         99,    99,    56],
[   99,      99,      99,   "r28", 99,   99,  99,  "r28",   "r28",    99,        99,  99,   99,"r28",  99, 99,   99,   99, "r28",     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,      99, 99,   99,  99,     99,     99,     99,        99,  99,   99,   99,  99, 99,   99,   99,    99,     99,"r10",   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99],
[   99,      99,      99,    "r5", 99,   99,  99,   "r5",   "r5",     99,        99,  99,   99, "r5",  99, 99,   99,   99,    99,     99,   99,   99, 99, 99,  99,  99,  99,  99,   99,  99,   99,   99,   99,         99,    99,    99]

gramatica = ["P'->1", "P->3", "V->2", "LV->2","LV->2", "D->3", "TIPO->1", "TIPO->1", "TIPO->1", "A->2", "ES->3", "ES->3", "ARG->1", "ARG->1", "ARG->1", "A->2", "CMD->4", "LD->3", "LD->1", "OPRD->1", "OPRD->1", "A->2", "COND->2", "CABECALHO->5", "EXP_R->3", "CORPO->2", "CORPO->2", "CORPO->2", "CORPO->1", "A->1"]
coluna = [ "inicio", "varinicio", "varfim", "id", "pt_v", "Inteiro", "real", "leia", "escreva", "literal", "num", "rcb", "opm", "se", "ab_p", "fc_p", "entao", "opr","fimse", "fim", "$", "P", "V", "LV", "D", "TIPO", "A", "ES", "ARG", "CMD", "LD", "OPRD", "COND","CABECALHO","EXP_R", "CORPO"]
producoes = ["P'->P", "P->inicio V A", "V-> varinicio LV", "LV->D LV","LV-> varfim ;", "D-> id TIPO ;", "TIPO-> int", "TIPO->real", "TIPO-> literal", "A->ES A", "ES-> leia id ;", "ES-> escreva ARG ;", "ARG-> literal", "ARG-> num", "ARG->id", "A-> CMD A", "CMD-> id rcb LD ;", "LD-> OPRD opm OPRD", "LD-> OPRD", "OPRD-> id", "OPRD-> num", "A-> COND A", "COND-> CABECALHO CORPO", "CABECALHO-> se ( EXP_R ) entao", "EXP_R->OPRD opr OPRD", "CORPO-> ES CORPO", "CORPO-> CMD CORPO", "CORPO-> COND CORPO", "CORPO->fimse", "A->fim"]

stack = [0]

def separa_token(lexema):
    aux = lexema.split(",")
    aux2 = aux[1].replace(")", "")
    aux2 = aux2.replace("Token='", "")
    aux2 = aux2.replace("'", "")
    aux2 = aux2.replace(" ","")
    return aux2

def busca_lexico(lexema):
    arquivo = open("output.txt", "r")
    linha = 0
    """aux = "Lexema='"+lexema+"'" """
    aux = "Lexema='inicio'"
    while(True):
        linha = arquivo.readline()
        if(aux in linha):
            return str(linha)
        elif(linha == ""):
            break

def separa_reducao(reducao):
    return reducao.replace("r", "")

def __main__():
    fonte = open("texto.alg", "r")
    lexema = str(fonte.readline())
    s = stack[len(stack) - 1]
    while(True):
        print(lexema)
        a = busca_lexico(lexema)
        a = separa_token(a)
        try:
            indice = coluna.index(a)
        except:
            indice = -1
        lexema = fonte.readline()
        auxiliar = str(tabela_slr[s][indice])
        if(auxiliar.isdigit() == True and auxiliar != 99):
            stack.append(coluna[indice])
            stack.append(auxiliar)
        else:
            aux2 = gramatica[separa_reducao(auxiliar)-1]
            aux2 = aux2.split("->")
            split_esq = aux2[0]
            split_dir = aux2[1]
            aux3 = 0
            while(aux3 != split_dir):
                stack.pop()
                aux3 += 1
            stack.append(split_esq)
            print(producao[separa_reducao(auxiliar)-1])
            s = tabela_slr[stack[len(stack) - 1]][stack[len(stack)-2]]

__main__()
